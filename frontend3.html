<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bakery Shift Scheduler</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css">
</head>

<body>
    <div class="container mt-5">
        <h1 class="mb-4">Bakery Shift Scheduler</h1>

        <!-- User Creation Form -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Create New User</h5>
                <form id="userForm">
                    <div class="mb-3">
                        <label for="username" class="form-label">Username</label>
                        <input type="text" class="form-control" id="username" required>
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" required>
                    </div>
                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" required>
                    </div>
                    <div class="mb-3">
                        <label for="role" class="form-label">Role ID</label>
                        <input type="number" class="form-control" id="role" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Create User</button>
                </form>
            </div>
        </div>

        <!-- Shift Creation Form -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Create New Shift</h5>
                <form id="shiftForm">
                    <div class="mb-3">
                        <label for="shiftDate" class="form-label">Shift Date</label>
                        <input type="date" class="form-control" id="shiftDate" required>
                    </div>
                    <div class="mb-3">
                        <label for="startTime" class="form-label">Start Time</label>
                        <input type="time" class="form-control" id="startTime" required>
                    </div>
                    <div class="mb-3">
                        <label for="endTime" class="form-label">End Time</label>
                        <input type="time" class="form-control" id="endTime" required>
                    </div>
                    <div class="mb-3">
                        <label for="numTrainee" class="form-label">Number of Trainees Needed</label>
                        <input type="number" class="form-control" id="numTrainee" required>
                    </div>
                    <div class="mb-3">
                        <label for="numTrained" class="form-label">Number of Trained Staff Needed</label>
                        <input type="number" class="form-control" id="numTrained" required>
                    </div>
                    <div class="mb-3">
                        <label for="numTrainer" class="form-label">Number of Trainers Needed</label>
                        <input type="number" class="form-control" id="numTrainer" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Shift</button>
                </form>
            </div>
        </div>

        <!-- Shift Assignment Form -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">Assign User to Shift</h5>
                <form id="assignmentForm">
                    <div class="mb-3">
                        <label for="shiftId" class="form-label">Shift ID</label>
                        <select class="form-select" id="shiftId" required></select>
                    </div>
                    <div class="mb-3">
                        <label for="userId" class="form-label">User ID</label>
                        <select class="form-select" id="userId" required></select>
                    </div>
                    <div class="mb-3">
                        <label for="assignmentRoleId" class="form-label">Role ID</label>
                        <input type="number" class="form-control" id="assignmentRoleId" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Assign User to Shift</button>
                </form>
            </div>
        </div>

        <!-- List of Users -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">List of Users</h5>
                <button id="loadUsers" class="btn btn-secondary mb-3">Load Users</button>
                <ul id="userList" class="list-group"></ul>
            </div>
        </div>

        <!-- List of Shifts -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">List of Shifts</h5>
                <button id="loadShifts" class="btn btn-secondary mb-3">Load Shifts</button>
                <ul id="shiftList" class="list-group"></ul>
            </div>
        </div>

        <!-- List of Shift Assignments -->
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">List of Shift Assignments</h5>
                <button id="loadAssignments" class="btn btn-secondary mb-3">Load Assignments</button>
                <ul id="assignmentList" class="list-group"></ul>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Submit user creation form
        $('#userForm').submit(function (event) {
            event.preventDefault();
            const userData = {
                username: $('#username').val(),
                email: $('#email').val(),
                password: $('#password').val(),
                role_id: parseInt($('#role').val())
            };

            $.ajax({
                url: 'http://127.0.0.1:5000/users',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(userData),
                success: function (response) {
                    alert('User created successfully!');
                    $('#userForm')[0].reset();
                },
                error: function (xhr, status, error) {
                    alert('Error: ' + xhr.responseJSON.message);
                }
            });
        });

        // Submit shift creation form
        $('#shiftForm').submit(function (event) {
            event.preventDefault();
            const shiftData = {
                shift_date: $('#shiftDate').val(),
                start_time: $('#startTime').val() + ':00',
                end_time: $('#endTime').val() + ':00',
                num_trainee_needed: parseInt($('#numTrainee').val()),
                num_trained_needed: parseInt($('#numTrained').val()),
                num_trainer_needed: parseInt($('#numTrainer').val())
            };

            $.ajax({
                url: 'http://127.0.0.1:5000/shifts',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(shiftData),
                success: function (response) {
                    alert('Shift created successfully!');
                    $('#shiftForm')[0].reset();
                },
                error: function (xhr, status, error) {
                    alert('Error: ' + xhr.responseJSON.message);
                }
            });
        });

        // Submit shift assignment form
        $('#assignmentForm').submit(function (event) {
            event.preventDefault();
            const assignmentData = {
                shift_id: parseInt($('#shiftId').val()),
                user_id: parseInt($('#userId').val()),
                role_id: parseInt($('#assignmentRoleId').val())
            };

            $.ajax({
                url: 'http://127.0.0.1:5000/shift_assignments',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(assignmentData),
                success: function (response) {
                    alert('User assigned to shift successfully!');
                    $('#assignmentForm')[0].reset();
                },
                error: function (xhr, status, error) {
                    alert('Error: ' + xhr.responseJSON.message);
                }
            });
        });

        // Load list of users
        $('#loadUsers').click(function () {
            $.ajax({
                url: 'http://127.0.0.1:5000/users',
                type: 'GET',
                success: function (response) {
                    $('#userList').empty();
                    response.forEach(function (user) {
                        $('#userList').append('<li class="list-group-item">ID: ' + user.user_id + ', Username: ' + user.username + ', Email: ' + user.email + ', Role ID: ' + user.role_id + '</li>');
                    });
                    loadUserOptions();
                },
                error: function (xhr, status, error) {
                    alert('Error: ' + xhr.responseJSON.message);
                }
            });
        });

        // Load list of shifts
        $('#loadShifts').click(function () {
            $.ajax({
                url: 'http://127.0.0.1:5000/shifts',
                type: 'GET',
                success: function (response) {
                    $('#shiftList').empty();
                    response.forEach(function (shift) {
                        $('#shiftList').append('<li class="list-group-item">ID: ' + shift.shift_id + ', Date: ' + shift.shift_date + ', Start: ' + shift.start_time + ', End: ' + shift.end_time + ', Trainees Needed: ' + shift.num_trainee_needed + ', Trained Needed: ' + shift.num_trained_needed + ', Trainers Needed: ' + shift.num_trainer_needed + '</li>');
                    });
                    loadShiftOptions();
                },
                error: function (xhr, status, error) {
                    alert('Error: ' + xhr.responseJSON.message);
                }
            });
        });

        // Load list of shift assignments
        $('#loadAssignments').click(function () {
            $.ajax({
                url: 'http://127.0.0.1:5000/shift_assignments',
                type: 'GET',
                success: function (response) {
                    $('#assignmentList').empty();
                    response.forEach(function (assignment) {
                        $('#assignmentList').append('<li class="list-group-item">Assignment ID: ' + assignment.assignment_id + ', Shift ID: ' + assignment.shift_id + ', User ID: ' + assignment.user_id + ', Role ID: ' + assignment.role_id + '</li>');
                    });
                },
                error: function (xhr, status, error) {
                    alert('Error: ' + xhr.responseJSON.message);
                }
            });
        });

        // Load user options for assignment
        function loadUserOptions() {
            $.ajax({
                url: 'http://127.0.0.1:5000/users',
                type: 'GET',
                success: function (response) {
                    $('#userId').empty();
                    response.forEach(function (user) {
                        $('#userId').append('<option value="' + user.user_id + '">' + user.username + '</option>');
                    });
                },
                error: function (xhr, status, error) {
                    alert('Error: ' + xhr.responseJSON.message);
                }
            });
        }

        // Load shift options for assignment
        function loadShiftOptions() {
            $.ajax({
                url: 'http://127.0.0.1:5000/shifts',
                type: 'GET',
                success: function (response) {
                    $('#shiftId').empty();
                    response.forEach(function (shift) {
                        $('#shiftId').append('<option value="' + shift.shift_id + '">' + shift.shift_date + ' from ' + shift.start_time + ' to ' + shift.end_time + '</option>');
                    });
                },
                error: function (xhr, status, error) {
                    alert('Error: ' + xhr.responseJSON.message);
                }
            });
        }
    </script>
</body>

</html>