<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bakery Shift Scheduler</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        h1 {
            text-align: center;
        }

        form {
            margin-bottom: 20px;
        }

        input,
        select {
            margin: 5px;
            padding: 10px;
            width: 200px;
        }

        button {
            padding: 10px 15px;
        }

        .user-list,
        .shift-list,
        .assignment-list {
            margin-top: 20px;
        }
    </style>
</head>

<body>

    <h1>Bakery Shift Scheduler</h1>

    <!-- User Registration -->
    <h2>Create User</h2>
    <form id="userForm">
        <input type="text" id="username" placeholder="Username" required>
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Password" required>
        <select id="role_id" required>
            <option value="">Select Role</option>
            <option value="1">Baker</option>
            <option value="2">Manager</option>
        </select>
        <button type="submit">Add User</button>
    </form>

    <!-- Shift Creation -->
    <h2>Create Shift</h2>
    <form id="shiftForm">
        <input type="date" id="shift_date" required>
        <input type="time" id="start_time" required>
        <input type="time" id="end_time" required>
        <input type="number" id="num_trainee_needed" placeholder="Trainees Needed" min="0">
        <input type="number" id="num_trained_needed" placeholder="Trained Needed" min="0">
        <input type="number" id="num_trainer_needed" placeholder="Trainers Needed" min="0">
        <button type="submit">Add Shift</button>
    </form>

    <!-- Assign User to Shift -->
    <h2>Assign User to Shift</h2>
    <form id="assignmentForm">
        <select id="shift_id" required>
            <option value="">Select Shift</option>
        </select>
        <select id="user_id" required>
            <option value="">Select User</option>
        </select>
        <select id="assignment_role_id" required>
            <option value="">Select Role</option>
            <option value="1">Trainee</option>
            <option value="2">Trainer</option>
        </select>
        <button type="submit">Assign Shift</button>
    </form>

    <!-- Lists -->
    <div class="user-list">
        <h2>Users</h2>
        <ul id="userList"></ul>
    </div>

    <div class="shift-list">
        <h2>Shifts</h2>
        <ul id="shiftList"></ul>
    </div>

    <div class="assignment-list">
        <h2>Shift Assignments</h2>
        <ul id="assignmentList"></ul>
    </div>

    <script>
        const apiUrl = 'http://localhost:5000'; // Update with your API URL

        document.getElementById('userForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const userData = {
                username: document.getElementById('username').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value,
                role_id: document.getElementById('role_id').value
            };
            await fetch(`${apiUrl}/users`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(userData)
            });
            loadUsers();
        });

        document.getElementById('shiftForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const shiftData = {
                shift_date: document.getElementById('shift_date').value,
                start_time: document.getElementById('start_time').value,
                end_time: document.getElementById('end_time').value,
                num_trainee_needed: document.getElementById('num_trainee_needed').value,
                num_trained_needed: document.getElementById('num_trained_needed').value,
                num_trainer_needed: document.getElementById('num_trainer_needed').value
            };
            await fetch(`${apiUrl}/shifts`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(shiftData)
            });
            loadShifts();
        });

        document.getElementById('assignmentForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const assignmentData = {
                shift_id: document.getElementById('shift_id').value,
                user_id: document.getElementById('user_id').value,
                role_id: document.getElementById('assignment_role_id').value
            };
            await fetch(`${apiUrl}/shift_assignments`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(assignmentData)
            });
            loadAssignments();
        });

        async function loadUsers() {
            const response = await fetch(`${apiUrl}/users`);
            const users = await response.json();
            const userList = document.getElementById('userList');
            userList.innerHTML = '';
            users.forEach(user => {
                const li = document.createElement('li');
                li.textContent = `${user.username} (${user.email})`;
                userList.appendChild(li);
            });
        }

        async function loadShifts() {
            const response = await fetch(`${apiUrl}/shifts`);
            const shifts = await response.json();
            const shiftList = document.getElementById('shiftList');
            shiftList.innerHTML = '';
            shifts.forEach(shift => {
                const li = document.createElement('li');
                li.textContent = `${shift.shift_date} from ${shift.start_time} to ${shift.end_time}`;
                shiftList.appendChild(li);
            });
            loadShiftOptions();
        }

        async function loadAssignments() {
            const response = await fetch(`${apiUrl}/shift_assignments`);
            const assignments = await response.json();
            const assignmentList = document.getElementById('assignmentList');
            assignmentList.innerHTML = '';
            assignments.forEach(assignment => {
                const li = document.createElement('li');
                li.textContent = `User ID: ${assignment.user_id} assigned to Shift ID: ${assignment.shift_id}`;
                assignmentList.appendChild(li);
            });
        }

        async function loadShiftOptions() {
            const response = await fetch(`${apiUrl}/shifts`);
            const shifts = await response.json();
            const shiftSelect = document.getElementById('shift_id');
            shiftSelect.innerHTML = '<option value="">Select Shift</option>';
            shifts.forEach(shift => {
                const option = document.createElement('option');
                option.value = shift.shift_id;
                option.textContent = `${shift.shift_date} from ${shift.start_time} to ${shift.end_time}`;
                shiftSelect.appendChild(option);
            });
        }

        async function loadUserOptions() {
            const response = await fetch(`${apiUrl}/users`);
            const users = await response.json();
            const userSelect = document.getElementById('user_id');
            userSelect.innerHTML = '<option value="">Select User</option>';
            users.forEach(user => {
                const option = document.createElement('option');
                option.value = user.user_id;
                option.textContent = user.username;
                userSelect.appendChild(option);
            });
        }

        loadUsers();
        loadShifts();
        loadUserOptions();
        loadAssignments();
    </script>
</body>

</html>